<!DOCTYPE html><html lang="zh-CN"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.16.19"><meta name="description" content="Blog post"><title>Untitled</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet"><link rel="stylesheet" href="/_astro/_title_.8kzbYMPX.css"><script type="module">const e=()=>{document.querySelectorAll(".animate").forEach((t,s)=>{setTimeout(()=>{t.classList.add("show")},s*150)})};e();document.addEventListener("astro:after-swap",e);
</script></head> <body> <header> <div class="mx-auto max-w-screen-sm px-5">  <div class="flex flex-wrap gap-y-2 justify-between"> <a href="/" class="font-semibold hover:underline underline-offset-2">
Blog
</a> <nav class="flex gap-1">  <a href="/archive" class="hover:underline underline-offset-2"> Archive </a> <span>/</span> <a href="/about" class="hover:underline underline-offset-2"> About </a>  </nav> </div>  </div> </header> <main>  <div class="mx-auto max-w-screen-sm px-5">  <div class="animate"> <a href="/archive" class="hover:underline underline-offset-2">
← Back to archive
</a> </div> <div class="space-y-1 my-10"> <div class="animate flex items-center gap-1.5"> <div class="font-base text-sm"> <time datetime="2017-02-28T00:00:00.000Z"> February 28, 2017 </time> </div> </div> <div class="animate text-2xl font-semibold text-black dark:text-white">  </div>  </div> <article class="animate"> <h2 id="title-golang-101-hacksdate-2017-02-28-094907categories-golangtags-golang">title: Golang-101-hacks
date: 2017-02-28 09:49:07
categories: golang
tags: [golang]</h2>
<h4 id="use-govendor-to-implement-vendoring">Use govendor to implement vendoring</h4>
<p>利用govendor部分，进行相关的依赖保证</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>govendor init</span></span>
<span class="line"><span></span></span>
<span class="line"><span>govendor add +external</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span></code></pre>
<p>这样我们在进行go get的时候，可以将相关的依赖同时下载下来。</p>
<h4 id="short-variable-declaration">short variable declaration</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>i := 10</span></span>
<span class="line"><span></span></span></code></pre>
<p>一般都会产生一个新的变量，这样要防止全局变量和局部变量之间的区别</p>
<h4 id="nil-silce-vs-nil-map">nil silce vs nil map</h4>
<p>Slice and map are all reference types in <code>Go</code>, and their default values are <code>nil</code></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span> var s1 []int</span></span>
<span class="line"><span> s2 := []int{}</span></span>
<span class="line"><span></span></span></code></pre>
<p>上述两种方式，第二种的命名s2非<code>nil</code>，但同样长度为0</p>
<!--more-->
<h4 id="init-function">init function</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>var WhatIsThe = AnswerToLife()</span></span>
<span class="line"><span></span></span>
<span class="line"><span>func AnswerToLife() int {</span></span>
<span class="line"><span>    return 42</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>func init() {</span></span>
<span class="line"><span>    WhatIsThe = 0</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>func main() {</span></span>
<span class="line"><span>    if WhatIsThe == 0 {</span></span>
<span class="line"><span>        fmt.Println("It's all a lie.")</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span></code></pre>
<p>上述初始化的顺序，<code>AnswerToLife()</code> -> <code>init()</code> -> <code>main()</code></p>
<h4 id="the-internals-of-slice">The internals of slice</h4>
<p>包含3部分</p>
<ul>
<li>
<p><code>pointer</code></p>
</li>
<li>
<p><code>length</code></p>
</li>
<li>
<p><code>capacity</code></p>
</li>
</ul>
<h4 id="gdb">gdb</h4>
<p>采用gdb调试golang代码？</p>
<h4 id="pass-slice-as-a-function-argument">Pass slice as a function argument</h4>
<blockquote>
<p>In Go, the function parameters are passed by value. With respect to use slice as a function argument, that means the function will get the copies of the slice: a pointer which points to the starting address of the underlying array, accompanied by the length and capacity of the slice.</p>
</blockquote>
<p>golang中采用的值传递的方式，如果需要改变相关的值的话，需要传递相关的指针？</p>
<p>但针对array来说，</p>
<blockquote>
<p>since in Go, the function argument is passed by “value”, so if you use an array as a function argument, the function just does the operations on the copy of the original copy.</p>
</blockquote>
<p>关于slice和array之间的区别问题</p>
<blockquote>
<p>In Go, array is a fixed length of continuous memory with specified type, while slice is just a reference which points to an underlying array.</p>
</blockquote>
<p>可以从array来创建slice，但反之不行。。</p>
<h4 id="two-dimensional-slice">Two-dimensional slice</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>func main() {</span></span>
<span class="line"><span>    s := make([][]int, 2)</span></span>
<span class="line"><span>    fmt.Println(len(s), cap(s), &#x26;s[0])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    s[0] = []int{1, 2, 3}</span></span>
<span class="line"><span>    fmt.Println(len(s[0]), cap(s[0]), &#x26;s[0][0])</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    s[1] = make([]int, 3, 5)</span></span>
<span class="line"><span>    fmt.Println(len(s[1]), cap(s[1]), &#x26;s[1][0])</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span></code></pre>
<p>二维数组？</p>
<h4 id="reallocating-underlying-array-of-slice">Reallocating underlying array of slice</h4>
<p>在append的使用过程中，可能会在未通知你的情况下改变数组</p>
<h4 id="type-assertion-and-type-switch">Type assertion and type switch</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span> if v, ok := v.(string); ok {</span></span>
<span class="line"><span>        fmt.Printf("The value of v is: %v", v)</span></span>
<span class="line"><span>    } else {</span></span>
<span class="line"><span>        fmt.Println("Oops, it is not a string!")</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span></code></pre>
<p>采用这种方式，方式在type assertion的过程中发生的panic错误</p>
<h4 id="ioreader">io.reader</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span></span></span>
<span class="line"><span>p := make([]byte, 4)</span></span>
<span class="line"><span>    for {</span></span>
<span class="line"><span>        if n, err := file.Read(p); n > 0 {</span></span>
<span class="line"><span>            fmt.Printf("Read %s\n", p[:n])</span></span>
<span class="line"><span></span></span></code></pre>
<p>采用这种方式来进行file.read部分</p>
<p><code>bufferio</code>也提供read的功能</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>r := bufio.NewReader(f)</span></span>
<span class="line"><span>        for {</span></span>
<span class="line"><span>                if s, err := r.ReadSlice('\n'); err == nil || err == io.EOF {</span></span>
<span class="line"><span>                        fmt.Printf("%s", s)</span></span>
<span class="line"><span></span></span></code></pre>
<p>以及采用<code>s := bufio.NewScanner(f)</code>的Scan的方式</p>
<h4 id="data-race">Data race</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span></span></span>
<span class="line"><span>go run -race main.go</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span></code></pre>
<p>采用这种方式，可以进行<code>race detector</code>部分，</p>
<h4 id="sort">Sort</h4>
<p>只要实现<code>Len</code>, <code>Swap</code>,以及<code>Less</code>的功能，即可针对interface进行sort操作</p>
<h4 id="close-channel">close channel</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>func main() {</span></span>
<span class="line"><span>    ch := make(chan int)</span></span>
<span class="line"><span>    go func(chan int) {</span></span>
<span class="line"><span>        for _, v := range []int{1, 2} {</span></span>
<span class="line"><span>            ch &#x3C;- v</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>        close(ch)</span></span>
<span class="line"><span>    }(ch)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    for v := range ch {</span></span>
<span class="line"><span>        fmt.Println(v)</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    fmt.Println("The channel is closed.")</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<p>We can see close(ch) statement in another goroutine make the loop in main goroutine end.</p>
<p>这部分的close操作的保证，有些奇怪？</p>
<h4 id="error-vs-errors">error vs errors</h4>
<p>errors核心部分的代码</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>package errors</span></span>
<span class="line"><span></span></span>
<span class="line"><span>func New(text string) error {</span></span>
<span class="line"><span>    return &#x26;errorString{text}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>type errorString struct {</span></span>
<span class="line"><span>    s string</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>func (e *errorString) Error() string {</span></span>
<span class="line"><span>    return e.s</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<h4 id="channel-types">channel types</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>var v &#x3C;-chan T</span></span>
<span class="line"><span></span></span></code></pre>
<p>read-only channel</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><span>var v chan&#x3C;- T</span></span>
<span class="line"><span></span></span></code></pre>
<p>write-only channel</p>
<h4 id="nil-channel-vs-closed-channel">nil channel vs closed channel</h4>
<blockquote>
<p>The Go’s built-in close function can be used to close the channel which must not be receive-only, and it should always be executed by sender, not receiver. Closing a nil channel will cause panic.</p>
</blockquote>
<p>关于内置的close方法</p>
<h4 id="select">select</h4>
<p>关于select操作部分</p>
<blockquote>
<p>The select operation will check which case branch can be run, that means the send or receive action can be executed successfully. If more than one case are ready now, the select will randomly choose one to execute.</p>
</blockquote>
<h4 id="need-not-close-every-channel">Need not close every channel</h4>
<blockquote>
<p>A channel that the garbage collector determines to be unreachable will have its resources reclaimed whether or not it is closed</p>
</blockquote> </article>  </div>  </main> <footer class="animate" data-astro-cid-sz7xmlte> <div class="mx-auto max-w-screen-sm px-5">  <div class="flex justify-between items-center" data-astro-cid-sz7xmlte> <div data-astro-cid-sz7xmlte>
&copy; 2026 | Blog
</div> <div class="flex flex-wrap gap-1 items-center" data-astro-cid-sz7xmlte> <button id="light-theme-button" aria-label="Light theme" class="group size-8 flex items-center justify-center rounded-full" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="group-hover:stroke-black group-hover:dark:stroke-white transition-colors duration-300 ease-in-out" data-astro-cid-sz7xmlte> <circle cx="12" cy="12" r="5" data-astro-cid-sz7xmlte></circle> <line x1="12" y1="1" x2="12" y2="3" data-astro-cid-sz7xmlte></line> <line x1="12" y1="21" x2="12" y2="23" data-astro-cid-sz7xmlte></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-astro-cid-sz7xmlte></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-astro-cid-sz7xmlte></line> <line x1="1" y1="12" x2="3" y2="12" data-astro-cid-sz7xmlte></line> <line x1="21" y1="12" x2="23" y2="12" data-astro-cid-sz7xmlte></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-astro-cid-sz7xmlte></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-astro-cid-sz7xmlte></line> </svg> </button> <button id="dark-theme-button" aria-label="Dark theme" class="group size-8 flex items-center justify-center rounded-full" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="group-hover:stroke-black group-hover:dark:stroke-white transition-colors duration-300 ease-in-out" data-astro-cid-sz7xmlte> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-astro-cid-sz7xmlte></path> </svg> </button> <button id="system-theme-button" aria-label="System theme" class="group size-8 flex items-center justify-center rounded-full" data-astro-cid-sz7xmlte> <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="group-hover:stroke-black group-hover:dark:stroke-white transition-colors duration-300 ease-in-out" data-astro-cid-sz7xmlte> <rect x="2" y="3" width="20" height="14" rx="2" ry="2" data-astro-cid-sz7xmlte></rect> <line x1="8" y1="21" x2="16" y2="21" data-astro-cid-sz7xmlte></line> <line x1="12" y1="17" x2="12" y2="21" data-astro-cid-sz7xmlte></line> </svg> </button> </div> </div>  </div> </footer>  <script>
  function setTheme(theme) {
    document.documentElement.classList.remove("light", "dark", "system");
    
    if (theme === "system") {
      document.documentElement.classList.add("system");
      const systemTheme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
      document.documentElement.classList.add(systemTheme);
    } else {
      document.documentElement.classList.add(theme);
    }
    
    localStorage.setItem("theme", theme);
  }

  document.getElementById("light-theme-button")?.addEventListener("click", () => setTheme("light"));
  document.getElementById("dark-theme-button")?.addEventListener("click", () => setTheme("dark"));
  document.getElementById("system-theme-button")?.addEventListener("click", () => setTheme("system"));

  const savedTheme = localStorage.getItem("theme") || "system";
  setTheme(savedTheme);
</script>  </body> </html>