<!DOCTYPE html><html lang="zh-CN"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.16.19"><title>Blog</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono&display=swap" rel="stylesheet"><style>:root{--primary: #2563eb;--text-main: #1f2937;--text-muted: #6b7280;--bg-main: #ffffff;--bg-secondary: #f9fafb;--border: #e5e7eb;--max-width: 800px;--font-sans: "Inter", system-ui, -apple-system, sans-serif;--font-mono: "JetBrains Mono", monospace}*{margin:0;padding:0;box-sizing:border-box}body{font-family:var(--font-sans);color:var(--text-main);background-color:var(--bg-main);line-height:1.6;-webkit-font-smoothing:antialiased}.app-container{display:flex;flex-direction:column;min-height:100vh}.navbar{border-bottom:1px solid var(--border);position:sticky;top:0;background:#fffc;backdrop-filter:blur(8px);z-index:100}.nav-content{max-width:var(--max-width);margin:0 auto;padding:1rem;display:flex;justify-content:space-between;align-items:center}.logo{text-decoration:none;color:var(--text-main);font-weight:800;font-size:1.5rem}.nav-links{list-style:none;display:flex;gap:1.5rem}.nav-links a{text-decoration:none;color:var(--text-muted);font-size:.95rem;font-weight:500;transition:color .2s}.nav-links a:hover{color:var(--primary)}.main-content{flex:1;max-width:var(--max-width);margin:0 auto;width:100%;padding:3rem 1rem}.footer{border-top:1px solid var(--border);background:var(--bg-secondary);padding:2rem 1rem;margin-top:4rem}.footer-content{max-width:var(--max-width);margin:0 auto;text-align:center;color:var(--text-muted);font-size:.9rem}.post-content h1,.post-content h2,.post-content h3{margin-top:2.5rem;margin-bottom:1rem;line-height:1.3}.post-content p{margin-bottom:1.5rem}.post-content img{max-width:100%;height:auto;border-radius:8px;margin:2rem 0}.post-content pre{border-radius:8px;padding:1.25rem;margin-bottom:2rem;font-family:var(--font-mono);font-size:.9rem;overflow-x:auto}.post-content code:not(pre code){background:var(--bg-secondary);padding:.2rem .4rem;border-radius:4px;font-family:var(--font-mono);font-size:.9em}.post-content blockquote{border-left:4px solid var(--primary);padding-left:1.5rem;font-style:italic;color:var(--text-muted);margin:2rem 0}.post-content ul,.post-content ol{margin-bottom:1.5rem;padding-left:1.5rem}.post-content li{margin-bottom:.5rem}
.post-header[data-astro-cid-rl3favg5]{margin-bottom:4rem;text-align:center}.post-date[data-astro-cid-rl3favg5]{display:block;font-size:.875rem;text-transform:uppercase;letter-spacing:.05em;color:var(--text-muted);font-weight:600;margin-bottom:1rem}.post-title[data-astro-cid-rl3favg5]{font-size:3rem;font-weight:800;line-height:1.1;margin-bottom:1.5rem;letter-spacing:-.025em}.post-meta[data-astro-cid-rl3favg5]{display:flex;justify-content:center;gap:1.5rem;font-size:.95rem;color:var(--text-muted)}.tag[data-astro-cid-rl3favg5]{color:var(--primary);margin-right:.5rem}@media (max-width: 640px){.post-title[data-astro-cid-rl3favg5]{font-size:2rem}}
</style></head> <body> <div class="app-container"> <header class="navbar"> <div class="nav-content"> <a href="/" class="logo"> <span class="logo-text">Blog</span> </a> <nav> <ul class="nav-links"> <li><a href="/">Home</a></li> <li><a href="/archive">Archive</a></li> <li><a href="/about">About</a></li> </ul> </nav> </div> </header> <main class="main-content">  <article class="post" data-astro-cid-rl3favg5> <header class="post-header" data-astro-cid-rl3favg5> <time class="post-date" data-astro-cid-rl3favg5> January 10, 2018 </time> <h1 class="post-title" data-astro-cid-rl3favg5></h1> <div class="post-meta" data-astro-cid-rl3favg5>   </div> </header> <div class="post-content" data-astro-cid-rl3favg5> <h2 id="title-golang-tipsdate-2018-01-10-151516categories-golangtags-golang">title: Golang Tips
date: 2018-01-10 15:15:16
categories: golang
tags: [golang]</h2>
<h3 id="go-datastructures-slices">Go Datastructures slices</h3>
<p><a href="https://speakerdeck.com/rarchana2001asu/go-datastructure-slices?utm_campaign=CodeTengu&#x26;utm_content=buffer2deee&#x26;utm_medium=email&#x26;utm_source=CodeTengu_111">go datastructures</a></p>
<p>diff between c arrays and go array</p>
<ul>
<li>array name in c is an alias, in go is reference/pointer</li>
<li>c arrays can passed to function as a pointer, but go is pass values</li>
<li>in c, array can not be copied like ar1 = ar2 unless ar1 and ar2 are pointer, but it is possible in go</li>
<li>c array should be freed, go supports garbage collection</li>
</ul>
<p>diff between go array and slice</p>
<ul>
<li>go slice is a 3 word data structure &#x3C;pointer, length, capacity></li>
</ul>
<p>slice is a collection of data in contiguous blocks of memory</p>
<p>Nil slice: <code>var slice[] int </code>, empty slice <code>slice:=make([]int, 0)</code> or <code>slice:=[]int{}</code></p>
<p>growing slice -> like java list, factor to grow? no..</p>
<p>growing in slice</p>
<ul>
<li>the append function takes in a source slice and append values and returns a new slice</li>
<li>append always increases the length of the new slice but capacity may or may not increase</li>
</ul>
<p>slice append - third index</p>
<ul>
<li>the third index of the slice restricts the capacity</li>
<li>slice:=source[2:3:4]</li>
<li>by setting the capacity == length, the new slice is forced to detach from source backing array and creates its own backing array</li>
<li>the above technique is used in scenarios where we just want to modify the new slice backing array without changing the source backing array</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#F97583">func</span><span style="color:#B392F0"> main</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#E1E4E8">	k</span><span style="color:#F97583">:=</span><span style="color:#B392F0">make</span><span style="color:#E1E4E8">([]</span><span style="color:#F97583">int</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">	</span></span>
<span class="line"><span style="color:#E1E4E8">	k </span><span style="color:#F97583">=</span><span style="color:#B392F0"> append</span><span style="color:#E1E4E8">(k, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">	k </span><span style="color:#F97583">=</span><span style="color:#B392F0"> append</span><span style="color:#E1E4E8">(k, </span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">	k </span><span style="color:#F97583">=</span><span style="color:#B392F0"> append</span><span style="color:#E1E4E8">(k, </span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">	k </span><span style="color:#F97583">=</span><span style="color:#B392F0"> append</span><span style="color:#E1E4E8">(k, </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">	k </span><span style="color:#F97583">=</span><span style="color:#B392F0"> append</span><span style="color:#E1E4E8">(k, </span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">	k </span><span style="color:#F97583">=</span><span style="color:#B392F0"> append</span><span style="color:#E1E4E8">(k, </span><span style="color:#79B8FF">6</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">	</span></span>
<span class="line"><span style="color:#E1E4E8">	t</span><span style="color:#F97583">:=</span><span style="color:#E1E4E8">k[</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">:</span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">:</span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">	</span></span>
<span class="line"><span style="color:#E1E4E8">	fmt.</span><span style="color:#B392F0">Println</span><span style="color:#E1E4E8">(k)</span></span>
<span class="line"><span style="color:#E1E4E8">	fmt.</span><span style="color:#B392F0">Println</span><span style="color:#E1E4E8">(t)</span></span>
<span class="line"><span style="color:#E1E4E8">	</span></span>
<span class="line"><span style="color:#E1E4E8">	t </span><span style="color:#F97583">=</span><span style="color:#B392F0"> append</span><span style="color:#E1E4E8">(t, </span><span style="color:#79B8FF">7</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">	</span></span>
<span class="line"><span style="color:#E1E4E8">	fmt.</span><span style="color:#B392F0">Println</span><span style="color:#E1E4E8">(k)</span></span>
<span class="line"><span style="color:#E1E4E8">	fmt.</span><span style="color:#B392F0">Println</span><span style="color:#E1E4E8">(t)</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<p>the reuslt:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#E1E4E8">[</span><span style="color:#79B8FF">1</span><span style="color:#79B8FF"> 2</span><span style="color:#79B8FF"> 3</span><span style="color:#79B8FF"> 4</span><span style="color:#79B8FF"> 5</span><span style="color:#79B8FF"> 6</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">[</span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">[</span><span style="color:#79B8FF">1</span><span style="color:#79B8FF"> 2</span><span style="color:#79B8FF"> 3</span><span style="color:#79B8FF"> 4</span><span style="color:#79B8FF"> 5</span><span style="color:#79B8FF"> 6</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">[</span><span style="color:#79B8FF">3</span><span style="color:#79B8FF"> 7</span><span style="color:#E1E4E8">]</span></span>
<span class="line"></span></code></pre>
<p>notice the detach operation</p>
<p>but  what the meaning of the capacity?</p>
<p>passing slices to functions</p>
<p>since only the pointer to the backing array is passed, this is very efficient. whether the size of the backing array is 10 or one million only 24 bytes are passed to function</p>
<h3 id="rfc-apache-beam-go-sdk-design">RFC: Apache Beam Go SDK design</h3>
<p><a href="https://docs.google.com/document/d/1yj0_hxq2J1iestjFUUrm_BVQLsFxQiiqtcFhgodzIgM/mobilebasic?utm_campaign=CodeTengu&#x26;utm_medium=email&#x26;utm_source=CodeTengu_111">RFC: Apache Beam Go SDK design</a></p>
<p><a href="https://beam.apache.org/">Apache Beam</a></p>
<p>is an advanced unified programming model, implement batch and streaming data processing jobs that run on any execution engine</p>
<p>weak point:</p>
<ul>
<li>no generics</li>
<li>no function or method overloading</li>
<li>no inheritance</li>
<li>limited reflection and serialization support</li>
<li>no annotation support</li>
</ul>
<p>strong point:</p>
<ul>
<li>first-class functions</li>
<li>full type reflection</li>
<li>multiple return values</li>
<li>and more</li>
</ul>
<h4 id="key-design-points">key design points</h4>
<ul>
<li>
<p>natively-typed dofns and other user functions</p>
<p>​</p>
</li>
<li>
<p>weakly-typed ptransforms that capture arity natively</p>
</li>
<li>
<p>static type checking at pipeline construction time</p>
<ul>
<li>kv is implicit. we use multiple arguments and return tuples to represent unfolded KV for DoFns</li>
<li>slide input forms.</li>
<li>simulated generic types. we achieve some of the effect of generics by introducing special ‘universal’ types T,U,… X,Y,Z over interface{}</li>
</ul>
</li>
<li>
<p>error handling</p>
</li>
</ul>
<h4 id="examples">examples</h4>
<h5 id="model-representation">model representation</h5>
<ul>
<li>Pipeline</li>
<li>Runner</li>
<li>PCollection</li>
<li>Coder</li>
<li>DoFn and other user functions</li>
</ul>
<h5 id="transforms">Transforms</h5>
<ul>
<li>Impulse</li>
<li>Create</li>
<li>ParDo family</li>
<li>GroupByKey</li>
<li>Flatten</li>
<li>Combine</li>
<li>Partition</li>
<li>​</li>
</ul> </div> </article>  </main> <footer class="footer"> <div class="footer-content"> <p>&copy; 2026 Liu Weifeng. Built with Astro.</p> </div> </footer> </div> </body></html> 