<!DOCTYPE html><html lang="zh-CN"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.16.19"><title>Blog</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono&display=swap" rel="stylesheet"><style>:root{--primary: #2563eb;--text-main: #1f2937;--text-muted: #6b7280;--bg-main: #ffffff;--bg-secondary: #f9fafb;--border: #e5e7eb;--max-width: 800px;--font-sans: "Inter", system-ui, -apple-system, sans-serif;--font-mono: "JetBrains Mono", monospace}*{margin:0;padding:0;box-sizing:border-box}body{font-family:var(--font-sans);color:var(--text-main);background-color:var(--bg-main);line-height:1.6;-webkit-font-smoothing:antialiased}.app-container{display:flex;flex-direction:column;min-height:100vh}.navbar{border-bottom:1px solid var(--border);position:sticky;top:0;background:#fffc;backdrop-filter:blur(8px);z-index:100}.nav-content{max-width:var(--max-width);margin:0 auto;padding:1rem;display:flex;justify-content:space-between;align-items:center}.logo{text-decoration:none;color:var(--text-main);font-weight:800;font-size:1.5rem}.nav-links{list-style:none;display:flex;gap:1.5rem}.nav-links a{text-decoration:none;color:var(--text-muted);font-size:.95rem;font-weight:500;transition:color .2s}.nav-links a:hover{color:var(--primary)}.main-content{flex:1;max-width:var(--max-width);margin:0 auto;width:100%;padding:3rem 1rem}.footer{border-top:1px solid var(--border);background:var(--bg-secondary);padding:2rem 1rem;margin-top:4rem}.footer-content{max-width:var(--max-width);margin:0 auto;text-align:center;color:var(--text-muted);font-size:.9rem}.post-content h1,.post-content h2,.post-content h3{margin-top:2.5rem;margin-bottom:1rem;line-height:1.3}.post-content p{margin-bottom:1.5rem}.post-content img{max-width:100%;height:auto;border-radius:8px;margin:2rem 0}.post-content pre{border-radius:8px;padding:1.25rem;margin-bottom:2rem;font-family:var(--font-mono);font-size:.9rem;overflow-x:auto}.post-content code:not(pre code){background:var(--bg-secondary);padding:.2rem .4rem;border-radius:4px;font-family:var(--font-mono);font-size:.9em}.post-content blockquote{border-left:4px solid var(--primary);padding-left:1.5rem;font-style:italic;color:var(--text-muted);margin:2rem 0}.post-content ul,.post-content ol{margin-bottom:1.5rem;padding-left:1.5rem}.post-content li{margin-bottom:.5rem}
.post-header[data-astro-cid-rl3favg5]{margin-bottom:4rem;text-align:center}.post-date[data-astro-cid-rl3favg5]{display:block;font-size:.875rem;text-transform:uppercase;letter-spacing:.05em;color:var(--text-muted);font-weight:600;margin-bottom:1rem}.post-title[data-astro-cid-rl3favg5]{font-size:3rem;font-weight:800;line-height:1.1;margin-bottom:1.5rem;letter-spacing:-.025em}.post-meta[data-astro-cid-rl3favg5]{display:flex;justify-content:center;gap:1.5rem;font-size:.95rem;color:var(--text-muted)}.tag[data-astro-cid-rl3favg5]{color:var(--primary);margin-right:.5rem}@media (max-width: 640px){.post-title[data-astro-cid-rl3favg5]{font-size:2rem}}
</style></head> <body> <div class="app-container"> <header class="navbar"> <div class="nav-content"> <a href="/" class="logo"> <span class="logo-text">Blog</span> </a> <nav> <ul class="nav-links"> <li><a href="/">Home</a></li> <li><a href="/archive">Archive</a></li> <li><a href="/about">About</a></li> </ul> </nav> </div> </header> <main class="main-content">  <article class="post" data-astro-cid-rl3favg5> <header class="post-header" data-astro-cid-rl3favg5> <time class="post-date" data-astro-cid-rl3favg5> July 2, 2019 </time> <h1 class="post-title" data-astro-cid-rl3favg5></h1> <div class="post-meta" data-astro-cid-rl3favg5>   </div> </header> <div class="post-content" data-astro-cid-rl3favg5> <p>title : Rest vs GRPC
date : 2019-07-02 19:59:55
categories : GPRC
tags : [grpc]</p>
<hr>
<p><a href="https://blog.maddevs.io/go-rest-or-grpc-5eace88499bd">原文链接</a></p>
<p>When you use swagger, there is a big temptation not to support the documentation, because it is often an additional problem. When you use gRPC, it will not happen, this improved tool makes the developer’s life easier because it is impossible to write the code without a proto file and without sharing to development teams. 代码与文档部分</p>
<p><strong>gRPC</strong> is primarily an RPC framework and it refers to UpdateBalance, GetClient methods.</p>
<p><strong>REST</strong> is about resources such a GET /users, POST /users and etc.</p>
<p>grpc-gateway，同时支持grpc和rest部分</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="protobuf"><code><span class="line"><span style="color:#F97583">syntax</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> "proto3"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#9ECBFF"> "google/api/annotations.proto"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">package</span><span style="color:#9ECBFF"> helloworld</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">service</span><span style="color:#B392F0"> Greeter</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">	rpc</span><span style="color:#B392F0"> SayHello</span><span style="color:#E1E4E8"> (</span><span style="color:#B392F0">HelloRequest</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">returns</span><span style="color:#E1E4E8"> (</span><span style="color:#B392F0">HelloReply</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#B392F0">		option</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">google</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">api</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">http</span><span style="color:#E1E4E8">) = {</span></span>
<span class="line"><span style="color:#B392F0">			get</span><span style="color:#E1E4E8">: "/</span><span style="color:#B392F0">api</span><span style="color:#E1E4E8">/</span><span style="color:#B392F0">hello</span><span style="color:#E1E4E8">/{</span><span style="color:#B392F0">name</span><span style="color:#E1E4E8">}",</span></span>
<span class="line"><span style="color:#E1E4E8">		};</span></span>
<span class="line"><span style="color:#E1E4E8">	}</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">message</span><span style="color:#B392F0"> HelloRequest</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">	string</span><span style="color:#E1E4E8"> name </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">message</span><span style="color:#B392F0"> HelloReply</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">	string</span><span style="color:#E1E4E8"> message </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#9ECBFF">TARGET=helloworld</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">all</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">clean build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">clean</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">	rm -rf $(TARGET)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">build</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">	go build -o $(TARGET) main.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">proto</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">	protoc -I/usr/local/include -I. \</span></span>
<span class="line"><span style="color:#9ECBFF">		-I${GOPATH}/src \</span></span>
<span class="line"><span style="color:#9ECBFF">		-I${GOPATH}/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \</span></span>
<span class="line"><span style="color:#9ECBFF">		--go_out=plugins=grpc:. \</span></span>
<span class="line"><span style="color:#9ECBFF">		pb/hello.proto</span></span>
<span class="line"><span style="color:#9ECBFF">	protoc -I/usr/local/include -I. \</span></span>
<span class="line"><span style="color:#9ECBFF">		-I${GOPATH}/src \</span></span>
<span class="line"><span style="color:#9ECBFF">		-I${GOPATH}/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \</span></span>
<span class="line"><span style="color:#9ECBFF">		--grpc-gateway_out=logtostderr=true:. \</span></span>
<span class="line"><span style="color:#9ECBFF">		pb/hello.proto</span></span>
<span class="line"><span style="color:#9ECBFF">	protoc -I/usr/local/include -I. \</span></span>
<span class="line"><span style="color:#9ECBFF">		-I${GOPATH}/src \</span></span>
<span class="line"><span style="color:#9ECBFF">		-I${GOPATH}/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \</span></span>
<span class="line"><span style="color:#9ECBFF">		--swagger_out=logtostderr=true:. \</span></span>
<span class="line"><span style="color:#9ECBFF">pb/hello.proto</span></span>
<span class="line"></span></code></pre>
<p>Now there is a small problem — our server will listen two TCP sockets. One is to ensure the operation of the gRPC mechanisms, and the second is to ensure REST. In addition, the gateway will be released as an intermediary, converting the JSON HTTP REST representation into gRPC on the proto files. ?</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#F97583">func</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">g </span><span style="color:#F97583">*</span><span style="color:#B392F0">Greeter</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">startGRPC</span><span style="color:#E1E4E8">() </span><span style="color:#F97583">error</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	lis, err </span><span style="color:#F97583">:=</span><span style="color:#E1E4E8"> net.</span><span style="color:#B392F0">Listen</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"tcp"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"localhost:8080"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">	if</span><span style="color:#E1E4E8"> err </span><span style="color:#F97583">!=</span><span style="color:#79B8FF"> nil</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">		return</span><span style="color:#E1E4E8"> err</span></span>
<span class="line"><span style="color:#E1E4E8">	}</span></span>
<span class="line"><span style="color:#E1E4E8">	grpcServer </span><span style="color:#F97583">:=</span><span style="color:#E1E4E8"> grpc.</span><span style="color:#B392F0">NewServer</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">	pb.</span><span style="color:#B392F0">RegisterGreeterServer</span><span style="color:#E1E4E8">(grpcServer, g)</span></span>
<span class="line"><span style="color:#E1E4E8">	grpcServer.</span><span style="color:#B392F0">Serve</span><span style="color:#E1E4E8">(lis)</span></span>
<span class="line"><span style="color:#F97583">	return</span><span style="color:#79B8FF"> nil</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"><span style="color:#F97583">func</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">g </span><span style="color:#F97583">*</span><span style="color:#B392F0">Greeter</span><span style="color:#E1E4E8">) </span><span style="color:#B392F0">startREST</span><span style="color:#E1E4E8">() </span><span style="color:#F97583">error</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">	ctx </span><span style="color:#F97583">:=</span><span style="color:#E1E4E8"> context.</span><span style="color:#B392F0">Background</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">	ctx, cancel </span><span style="color:#F97583">:=</span><span style="color:#E1E4E8"> context.</span><span style="color:#B392F0">WithCancel</span><span style="color:#E1E4E8">(ctx)</span></span>
<span class="line"><span style="color:#F97583">	defer</span><span style="color:#B392F0"> cancel</span><span style="color:#E1E4E8">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">	mux </span><span style="color:#F97583">:=</span><span style="color:#E1E4E8"> runtime.</span><span style="color:#B392F0">NewServeMux</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">	opts </span><span style="color:#F97583">:=</span><span style="color:#E1E4E8"> []</span><span style="color:#B392F0">grpc</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">DialOption</span><span style="color:#E1E4E8">{grpc.</span><span style="color:#B392F0">WithInsecure</span><span style="color:#E1E4E8">()}</span></span>
<span class="line"><span style="color:#E1E4E8">	err </span><span style="color:#F97583">:=</span><span style="color:#E1E4E8"> pb.</span><span style="color:#B392F0">RegisterGreeterHandlerFromEndpoint</span><span style="color:#E1E4E8">(ctx, mux, </span><span style="color:#9ECBFF">":8080"</span><span style="color:#E1E4E8">, opts)</span></span>
<span class="line"><span style="color:#F97583">	if</span><span style="color:#E1E4E8"> err </span><span style="color:#F97583">!=</span><span style="color:#79B8FF"> nil</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">		return</span><span style="color:#E1E4E8"> err</span></span>
<span class="line"><span style="color:#E1E4E8">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">	return</span><span style="color:#E1E4E8"> http.</span><span style="color:#B392F0">ListenAndServe</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">":8090"</span><span style="color:#E1E4E8">, mux)</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span></code></pre> </div> </article>  </main> <footer class="footer"> <div class="footer-content"> <p>&copy; 2026 Liu Weifeng. Built with Astro.</p> </div> </footer> </div> </body></html> 