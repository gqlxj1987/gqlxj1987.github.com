<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"gqlxj1987.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="DevilKing&#39;s blog">
<meta property="og:url" content="https://gqlxj1987.github.io/page/96/index.html">
<meta property="og:site_name" content="DevilKing&#39;s blog">
<meta property="og:locale">
<meta property="article:author" content="gqlxj1987">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://gqlxj1987.github.io/page/96/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>DevilKing's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">DevilKing's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">冷灯看剑，剑上几分功名？炉香无需计苍生，纵一穿烟逝，万丈云埋，孤阳还照古陵</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://gqlxj1987.github.io/2018/04/04/spelling-translate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gqlxj1987">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DevilKing's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/04/spelling-translate/" class="post-title-link" itemprop="url">Spelling Translate</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-04 14:50:11" itemprop="dateCreated datePublished" datetime="2018-04-04T14:50:11+08:00">2018-04-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="http://www.pinchofintelligence.com/old-spelling-to-new-spelling-with-tensorflow/">原文链接</a></p>
<h3 id="prepartion"><a href="#prepartion" class="headerlink" title="prepartion"></a>prepartion</h3><p>选用RNN的网络，主要是针对词来算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">Xdata = []</span><br><span class="line">Ydata = []</span><br><span class="line">MAX_LENGTH_WORD = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">feature_dict= <span class="built_in">dict</span>()</span><br><span class="line">feature_list = <span class="built_in">list</span>()</span><br><span class="line"></span><br><span class="line">PADDING_CHARACTER = <span class="string">&#x27;~&#x27;</span></span><br><span class="line">feature_dict[PADDING_CHARACTER]=<span class="number">0</span></span><br><span class="line">feature_list.append(PADDING_CHARACTER)</span><br><span class="line">max_features = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_vector_from_string</span>(<span class="params">input_s</span>):</span></span><br><span class="line">    <span class="keyword">global</span> max_features</span><br><span class="line">    vector_x = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> input_s:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> feature_dict:</span><br><span class="line">            feature_dict[i]=max_features</span><br><span class="line">            feature_list.append(i)</span><br><span class="line">            max_features += <span class="number">1</span></span><br><span class="line">        vector_x.append(feature_dict[i])</span><br><span class="line">    <span class="keyword">return</span> vector_x</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_to_data</span>(<span class="params">input_s,output_s</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(input_s) &lt; MAX_LENGTH_WORD <span class="keyword">and</span> <span class="built_in">len</span>(output_s) &lt; MAX_LENGTH_WORD:</span><br><span class="line">        vector_x = get_vector_from_string(input_s)</span><br><span class="line">        vector_y = get_vector_from_string(output_s)</span><br><span class="line">        Xdata.append(vector_x)</span><br><span class="line">        Ydata.append(vector_y)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_vector</span>(<span class="params">vector,end_token=<span class="string">&#x27;\n&#x27;</span></span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([feature_list[i] <span class="keyword">for</span> i <span class="keyword">in</span> vector]),end=end_token)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;dictionary_old_new_dutch.csv&quot;</span>) <span class="keyword">as</span> in_file:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> in_file:</span><br><span class="line">            in_s,out_s = line.strip().split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">            add_to_data(in_s,out_s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    print_vector(Xdata[i],end_token=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27; -&gt; &#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    print_vector(Ydata[i])</span><br></pre></td></tr></table></figure>



<p>上面部分是将词转化成为vector，注意几点：</p>
<ul>
<li>限制max_length_word部分</li>
<li>这里面没有像之前lstm那样，通过记录词频的方式，来进行one_hot编码</li>
<li>feature_list记录所有的词，同时，feature_dict记录词进入feature_list的位置</li>
</ul>
<h3 id="data-preprocessing"><a href="#data-preprocessing" class="headerlink" title="data preprocessing"></a>data preprocessing</h3><p>As mentioned above I would like to use a sequence to sequence approach. Important for this approach is having a certain length of words. Words that are longer than that length have been discarded in de data-reading step above. Now we will add paddings to the words that are not long enough. — 对于不够的词增加相应的padding</p>
<p>Another important step is creating a train and a test set. We only show the network examples from the train set. At the end I will manually evaluate some of the examples in the testset and discuss what the network learned. During training we train in batches with a small amount of data. With a random data splitter we get a different trainset every run. — 挑选合适的训练集和测试集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">before_padding = Xdata[<span class="number">0</span>]</span><br><span class="line">Xdata = sequence.pad_sequences(Xdata, maxlen=MAX_LENGTH_WORD)</span><br><span class="line">Ydata = sequence.pad_sequences(Ydata, maxlen=MAX_LENGTH_WORD)</span><br><span class="line">after_padding  = Xdata[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">print_vector(before_padding,end_token=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot; -&gt; after padding: &quot;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">print_vector(after_padding)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataSplitter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,percentage</span>):</span></span><br><span class="line">        self.percentage = percentage</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">split_data</span>(<span class="params">self,data</span>):</span></span><br><span class="line">        splitpoint = <span class="built_in">int</span>(<span class="built_in">len</span>(data)*self.percentage)</span><br><span class="line">        <span class="keyword">return</span> data[:splitpoint], data[splitpoint:]</span><br><span class="line">splitter = DataSplitter(<span class="number">0.8</span>)</span><br><span class="line">Xdata,Xtest = splitter.split_data(Xdata)</span><br><span class="line">Ydata,Ytest = splitter.split_data(Ydata)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_random_reversed_dataset</span>(<span class="params">Xdata,Ydata,batch_size</span>):</span></span><br><span class="line">    newX = []</span><br><span class="line">    newY = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(batch_size):</span><br><span class="line">        index_taken = random.randint(<span class="number">0</span>,<span class="built_in">len</span>(Xdata)-<span class="number">1</span>)</span><br><span class="line">        newX.append(Xdata[index_taken])</span><br><span class="line">        newY.append(Ydata[index_taken][::-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> newX,newY</span><br></pre></td></tr></table></figure>



<p>这里的几点：</p>
<ul>
<li>使用sequence.pad_sequences警醒padding补充</li>
</ul>
<h3 id="The-network"><a href="#The-network" class="headerlink" title="The network"></a>The network</h3><ul>
<li>embeds our characters</li>
<li>has an encoder which returns a sequence of outputs</li>
<li>has an attention model which uses this sequence to generate output characters</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">batch_size = <span class="number">64</span></span><br><span class="line">memory_dim = <span class="number">256</span></span><br><span class="line">embedding_dim = <span class="number">32</span></span><br><span class="line"></span><br><span class="line">enc_input = [tf.placeholder(tf.int32, shape=(<span class="literal">None</span>,)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(MAX_LENGTH_WORD)]</span><br><span class="line">dec_output = [tf.placeholder(tf.int32, shape=(<span class="literal">None</span>,)) <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(MAX_LENGTH_WORD)]</span><br><span class="line"></span><br><span class="line">weights = [tf.ones_like(labels_t, dtype=tf.float32) <span class="keyword">for</span> labels_t <span class="keyword">in</span> enc_input]</span><br><span class="line"></span><br><span class="line">dec_inp = ([tf.zeros_like(enc_input[<span class="number">0</span>], dtype=np.int32)]+[dec_output[t] <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(MAX_LENGTH_WORD-<span class="number">1</span>)])</span><br><span class="line">empty_dec_inp = ([tf.zeros_like(enc_input[<span class="number">0</span>], dtype=np.int32,name=<span class="string">&quot;empty_dec_input&quot;</span>) <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(MAX_LENGTH_WORD)])</span><br><span class="line"></span><br><span class="line">cell = tf.nn.rnn_cell.GRUCell(memory_dim)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a train version of encoder-decoder, and a test version which does not feed the previous input</span></span><br><span class="line"><span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;decoder1&quot;</span>) <span class="keyword">as</span> scope:</span><br><span class="line">    outputs, _ = tf.nn.seq2seq.embedding_attention_seq2seq(enc_input,dec_inp,</span><br><span class="line">                                                           cell,max_features,max_features,</span><br><span class="line">                                                           embedding_dim, feed_previous=<span class="literal">False</span>)</span><br><span class="line"><span class="keyword">with</span> tf.variable_scope(<span class="string">&quot;decoder1&quot;</span>,reuse=<span class="literal">True</span>) <span class="keyword">as</span> scope:</span><br><span class="line">    runtime_outputs, _ = tf.nn.seq2seq.embedding_attention_seq2seq(enc_input,empty_dec_inp,</span><br><span class="line">                                                                    cell,max_features,max_features,</span><br><span class="line">                                                                   embedding_dim,feed_previous=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">loss = tf.nn.seq2seq.sequence_loss(outputs, dec_output, weights, max_features)</span><br><span class="line"></span><br><span class="line">optimizer = tf.train.AdamOptimizer()</span><br><span class="line">train_op = optimizer.minimize(loss)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Init everything</span></span><br><span class="line">sess = tf.InteractiveSession()</span><br><span class="line">sess.run(tf.initialize_all_variables())</span><br></pre></td></tr></table></figure>



<p>代码解析：</p>
<pre><code> 1. enc_input和dec_output分别是10dim的数组
 2. init weights部分
 3. memory_dim的意义？
 4. 采用的是GRUCell的小处理阀门
 5. feed_previous的意义？
</code></pre>
<h3 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> index_now <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1002</span>):</span><br><span class="line">    Xin,Yin = get_random_reversed_dataset(Xdata,Ydata,batch_size)</span><br><span class="line">    Xin = np.array(Xin).T</span><br><span class="line">    Yin = np.array(Yin).T</span><br><span class="line">    feed_dict = &#123;enc_input[t]: Xin[t] <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(MAX_LENGTH_WORD)&#125;</span><br><span class="line">    feed_dict.update(&#123;dec_output[t]: Yin[t] <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(MAX_LENGTH_WORD)&#125;)</span><br><span class="line">    _, l = sess.run([train_op,loss], feed_dict)</span><br><span class="line">    <span class="keyword">if</span> index_now%<span class="number">100</span>==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(l)</span><br></pre></td></tr></table></figure>



<p>每次选取不同的random的数据集来进行相关的训练，增加随机性部分？</p>
<h3 id="Train-analysis"><a href="#Train-analysis" class="headerlink" title="Train analysis"></a>Train analysis</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_reversed_max_string_logits</span>(<span class="params">logits</span>):</span></span><br><span class="line">    string_logits = logits[::-<span class="number">1</span>]</span><br><span class="line">    concatenated_string = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> logit <span class="keyword">in</span> string_logits:</span><br><span class="line">        val_here = np.argmax(logit)</span><br><span class="line">        concatenated_string += feature_list[val_here]</span><br><span class="line">    <span class="keyword">return</span> concatenated_string</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_out</span>(<span class="params">out</span>):</span></span><br><span class="line">    out = <span class="built_in">list</span>(<span class="built_in">zip</span>(*out))</span><br><span class="line">    out = out[:<span class="number">10</span>] <span class="comment"># only show the first 10 samples</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> index,string_logits <span class="keyword">in</span> <span class="built_in">enumerate</span>(out):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;input: &quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        print_vector(Xin[index])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;expected: &quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        expected= Yin[index][::-<span class="number">1</span>]</span><br><span class="line">        print_vector(expected)</span><br><span class="line">        </span><br><span class="line">        output = get_reversed_max_string_logits(string_logits)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;output: &quot;</span> + output)</span><br><span class="line">        </span><br><span class="line">         </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;==============&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Now run a small test to see what our network does with words</span></span><br><span class="line">RANDOM_TESTSIZE = <span class="number">5</span></span><br><span class="line">Xin,Yin = get_random_reversed_dataset(Xtest,Ytest,RANDOM_TESTSIZE)</span><br><span class="line">Xin_transposed = np.array(Xin).T</span><br><span class="line">Yin_transposed = np.array(Yin).T</span><br><span class="line">feed_dict = &#123;enc_input[t]: Xin_transposed[t] <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(MAX_LENGTH_WORD)&#125;</span><br><span class="line">out = sess.run(runtime_outputs, feed_dict)</span><br><span class="line">print_out(out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">translate_single_word</span>(<span class="params">word</span>):</span></span><br><span class="line">    Xin = [get_vector_from_string(word)]</span><br><span class="line">    Xin = sequence.pad_sequences(Xin, maxlen=MAX_LENGTH_WORD)</span><br><span class="line">    Xin_transposed = np.array(Xin).T</span><br><span class="line">    feed_dict = &#123;enc_input[t]: Xin_transposed[t] <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(MAX_LENGTH_WORD)&#125;</span><br><span class="line">    out = sess.run(runtime_outputs, feed_dict)</span><br><span class="line">    <span class="keyword">return</span> get_reversed_max_string_logits(out)</span><br><span class="line"></span><br><span class="line">interesting_words = [<span class="string">&quot;aerde&quot;</span>,<span class="string">&quot;duyster&quot;</span>, <span class="string">&quot;salfde&quot;</span>, <span class="string">&quot;ontstondt&quot;</span>, <span class="string">&quot;tusschen&quot;</span>,<span class="string">&quot;wacker&quot;</span>,<span class="string">&quot;voorraet&quot;</span>,<span class="string">&quot;gevreeset&quot;</span>,<span class="string">&quot;cleopatra&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> interesting_words:</span><br><span class="line">    <span class="built_in">print</span>(word + <span class="string">&quot; becomes: &quot;</span> + translate_single_word(word).replace(<span class="string">&quot;~&quot;</span>,<span class="string">&quot;&quot;</span>))</span><br></pre></td></tr></table></figure>



<p>代码解析：</p>
<ul>
<li>首先选取相应的test_case，训练处最终的结果，按照loss最小的参数</li>
<li>然后是通过run，得到single_word的translate的结果</li>
<li>相关输出的一些反转，通过vector还原成为相应的单词</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://gqlxj1987.github.io/2018/04/03/lstm-exmaple/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gqlxj1987">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DevilKing's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/03/lstm-exmaple/" class="post-title-link" itemprop="url">LSTM Example</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-03 17:51:48" itemprop="dateCreated datePublished" datetime="2018-04-03T17:51:48+08:00">2018-04-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://towardsdatascience.com/lstm-by-example-using-tensorflow-feb0c1968537">原文链接</a></p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*epcf2SBjRHBynBNFf-CpQA.png" alt="predict"></p>
<p>​                        Figure 1. LSTM cell with three inputs and 1 output.</p>
<p>A way to convert symbol to number is to assign a unique integer to each symbol based on frequency of occurrence</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_dataset</span>(<span class="params">words</span>):</span></span><br><span class="line">    count = collections.Counter(words).most_common()</span><br><span class="line">    dictionary = <span class="built_in">dict</span>()</span><br><span class="line">    <span class="keyword">for</span> word, _ <span class="keyword">in</span> count:</span><br><span class="line">        dictionary[word] = <span class="built_in">len</span>(dictionary)</span><br><span class="line">    reverse_dictionary = <span class="built_in">dict</span>(<span class="built_in">zip</span>(dictionary.values(), dictionary.keys()))</span><br><span class="line">    <span class="keyword">return</span> dictionary, reverse_dictionary</span><br></pre></td></tr></table></figure>



<p>上面就是采用通过词频的方式，来进行转化编码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RNN</span>(<span class="params">x, weights, biases</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># reshape to [1, n_input]</span></span><br><span class="line">    x = tf.reshape(x, [-<span class="number">1</span>, n_input])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Generate a n_input-element sequence of inputs</span></span><br><span class="line">    <span class="comment"># (eg. [had] [a] [general] -&gt; [20] [6] [33])</span></span><br><span class="line">    x = tf.split(x,n_input,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1-layer LSTM with n_hidden units.</span></span><br><span class="line">    rnn_cell = rnn.BasicLSTMCell(n_hidden)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># generate prediction</span></span><br><span class="line">    outputs, states = rnn.static_rnn(rnn_cell, x, dtype=tf.float32)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># there are n_input outputs but</span></span><br><span class="line">    <span class="comment"># we only want the last output</span></span><br><span class="line">    <span class="keyword">return</span> tf.matmul(outputs[-<span class="number">1</span>], weights[<span class="string">&#x27;out&#x27;</span>]) + biases[<span class="string">&#x27;out&#x27;</span>]</span><br></pre></td></tr></table></figure>



<p>Final notes:</p>
<ol>
<li>Using int to encode symbols is easy but the “meaning” of the word is lost. Symbol to int is used to simplify the discussion on building a LSTM application using Tensorflow. Word2Vec is a more optimal way of encoding symbols to vector.</li>
<li>One-hot vector representation of output is inefficient especially if we have a realistic vocabulary size. Oxford dictionary has over 170,000 words. The example above has 112. Again, this is only for simplifying the discussion.</li>
<li>The number of inputs in this example is 3, see what happens when you use other numbers (eg 4, 5 or more).</li>
</ol>
<hr>
<p>想法：</p>
<ul>
<li>one hot的进化？词语太多的话，数组170000？左右</li>
<li>关于word的meaning部分，采用word2vec的方式，</li>
<li>关于input的参数的使用？如何使用？</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://gqlxj1987.github.io/2018/04/03/GAN-example/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gqlxj1987">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DevilKing's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/03/GAN-example/" class="post-title-link" itemprop="url">GAN Example on Keras</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-03 10:57:11" itemprop="dateCreated datePublished" datetime="2018-04-03T10:57:11+08:00">2018-04-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://towardsdatascience.com/gan-by-example-using-keras-on-tensorflow-backend-1a6d515a60d0">原文链接</a></p>
<p>GAN is almost always explained like the case of a counterfeiter (Generative) and the police (Discriminator). Initially, the counterfeiter will show the police a fake money. The police says it is fake. The police gives feedback to the counterfeiter why the money is fake. The counterfeiter attempts to make a new fake money based on the feedback it received. The police says the money is still fake and offers a new set of feedback. The counterfeiter attempts to make a new fake money based on the latest feedback. The cycle continues indefinitely until the police is fooled by the fake money because it looks real</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*QHMGABbwL04x5VGYc_UWSA.png" alt="discriminator"></p>
<p>Figure 1. Discriminator of DCGAN tells how real an input image of a digit is. MNIST Dataset is used as ground truth for real images. Strided convolution instead of max-pooling down samples the image.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">self.D = Sequential()</span><br><span class="line">depth = <span class="number">64</span></span><br><span class="line">dropout = <span class="number">0.4</span></span><br><span class="line"><span class="comment"># In: 28 x 28 x 1, depth = 1</span></span><br><span class="line"><span class="comment"># Out: 14 x 14 x 1, depth=64</span></span><br><span class="line">input_shape = (self.img_rows, self.img_cols, self.channel)</span><br><span class="line">self.D.add(Conv2D(depth*<span class="number">1</span>, <span class="number">5</span>, strides=<span class="number">2</span>, input_shape=input_shape, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">self.D.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">self.D.add(Dropout(dropout))</span><br><span class="line"></span><br><span class="line">self.D.add(Conv2D(depth*<span class="number">2</span>, <span class="number">5</span>, strides=<span class="number">2</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">self.D.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">self.D.add(Dropout(dropout))</span><br><span class="line"></span><br><span class="line">self.D.add(Conv2D(depth*<span class="number">4</span>, <span class="number">5</span>, strides=<span class="number">2</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">self.D.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">self.D.add(Dropout(dropout))</span><br><span class="line"></span><br><span class="line">self.D.add(Conv2D(depth*<span class="number">8</span>, <span class="number">5</span>, strides=<span class="number">1</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">self.D.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">self.D.add(Dropout(dropout))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Out: 1-dim probability</span></span><br><span class="line">self.D.add(Flatten())</span><br><span class="line">self.D.add(Dense(<span class="number">1</span>))</span><br><span class="line">self.D.add(Activation(<span class="string">&#x27;sigmoid&#x27;</span>))</span><br><span class="line">self.D.summary()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://cdn-images-1.medium.com/max/1600/1*gvBT3h4JD7eUN0GexHwx2w.png" alt="generator"></p>
<p>Figure 2. Generator model synthesizes fake MNIST images from noise. Upsampling is used instead of fractionally-strided transposed convolution.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">self.G = Sequential()</span><br><span class="line">dropout = <span class="number">0.4</span></span><br><span class="line">depth = <span class="number">64</span>+<span class="number">64</span>+<span class="number">64</span>+<span class="number">64</span></span><br><span class="line">dim = <span class="number">7</span></span><br><span class="line"><span class="comment"># In: 100</span></span><br><span class="line"><span class="comment"># Out: dim x dim x depth</span></span><br><span class="line">self.G.add(Dense(dim*dim*depth, input_dim=<span class="number">100</span>))</span><br><span class="line">self.G.add(BatchNormalization(momentum=<span class="number">0.9</span>))</span><br><span class="line">self.G.add(Activation(<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">self.G.add(Reshape((dim, dim, depth)))</span><br><span class="line">self.G.add(Dropout(dropout))</span><br><span class="line"></span><br><span class="line"><span class="comment"># In: dim x dim x depth</span></span><br><span class="line"><span class="comment"># Out: 2*dim x 2*dim x depth/2</span></span><br><span class="line">self.G.add(UpSampling2D())</span><br><span class="line">self.G.add(Conv2DTranspose(<span class="built_in">int</span>(depth/<span class="number">2</span>), <span class="number">5</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">self.G.add(BatchNormalization(momentum=<span class="number">0.9</span>))</span><br><span class="line">self.G.add(Activation(<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line"></span><br><span class="line">self.G.add(UpSampling2D())</span><br><span class="line">self.G.add(Conv2DTranspose(<span class="built_in">int</span>(depth/<span class="number">4</span>), <span class="number">5</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">self.G.add(BatchNormalization(momentum=<span class="number">0.9</span>))</span><br><span class="line">self.G.add(Activation(<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line"></span><br><span class="line">self.G.add(Conv2DTranspose(<span class="built_in">int</span>(depth/<span class="number">8</span>), <span class="number">5</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">self.G.add(BatchNormalization(momentum=<span class="number">0.9</span>))</span><br><span class="line">self.G.add(Activation(<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Out: 28 x 28 x 1 grayscale image [0.0,1.0] per pix</span></span><br><span class="line">self.G.add(Conv2DTranspose(<span class="number">1</span>, <span class="number">5</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">self.G.add(Activation(<span class="string">&#x27;sigmoid&#x27;</span>))</span><br><span class="line">self.G.summary()</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn-images-1.medium.com/max/1600/1*PIpd1jHbPc2QrTOPhvxoaw.png" alt="model"></p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*N3nT9AXVnsFBta2R1eEMjg.png" alt="train model"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">images_train = self.x_train[np.random.randint(<span class="number">0</span>,</span><br><span class="line">     self.x_train.shape[<span class="number">0</span>], size=batch_size), :, :, :]</span><br><span class="line"> noise = np.random.uniform(-<span class="number">1.0</span>, <span class="number">1.0</span>, size=[batch_size, <span class="number">100</span>])</span><br><span class="line"> images_fake = self.generator.predict(noise)</span><br><span class="line"> x = np.concatenate((images_train, images_fake))</span><br><span class="line"> y = np.ones([<span class="number">2</span>*batch_size, <span class="number">1</span>])</span><br><span class="line"> y[batch_size:, :] = <span class="number">0</span></span><br><span class="line"> d_loss = self.discriminator.train_on_batch(x, y)</span><br><span class="line"></span><br><span class="line"> y = np.ones([batch_size, <span class="number">1</span>])</span><br><span class="line"> noise = np.random.uniform(-<span class="number">1.0</span>, <span class="number">1.0</span>, size=[batch_size, <span class="number">100</span>])</span><br><span class="line"> a_loss = self.adversarial.train_on_batch(noise, y)</span><br></pre></td></tr></table></figure>





<h3 id="Some-tips"><a href="#Some-tips" class="headerlink" title="Some tips"></a>Some tips</h3><p>Training GAN models requires a lot of patience due to its depth. Here are some pointers:</p>
<ol>
<li>Problem: generated images look like noise. Solution: use dropout on both Discriminator and Generator. Low dropout values (0.3 to 0.6) generate more realistic images.</li>
<li>Problem: Discriminator loss converges rapidly to zero thus preventing the Generator from learning. Solution: Do not pre-train the Discriminator. Instead make its learning rate bigger than the Adversarial model learning rate. Use a different training noise sample for the Generator.</li>
<li>Problem: generator images still look like noise. Solution: check if the activation, batch normalization and dropout are applied in the correct sequence.</li>
<li>Problem: figuring out the correct training/model parameters. Solution: start with some known working values from published papers and codes and adjust one parameter at a time. Before training for 2000 or more steps, observe the effect of parameter value adjustment at about 500 or 1000 steps.</li>
</ol>
<p>尝试使用kaggle来做下试验？</p>
<h2 id="tips"><a href="#tips" class="headerlink" title="tips:"></a>tips:</h2><p>在进行深度学习的时候，先尝试将相关图能画出来，讲流程图能画出来</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://gqlxj1987.github.io/2018/04/03/go101/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gqlxj1987">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DevilKing's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/03/go101/" class="post-title-link" itemprop="url">Go101</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-03 10:27:12" itemprop="dateCreated datePublished" datetime="2018-04-03T10:27:12+08:00">2018-04-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/go/" itemprop="url" rel="index"><span itemprop="name">go</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://go101.org/article/101.html">原文链接</a></p>
<h3 id="value-parts"><a href="#value-parts" class="headerlink" title="value parts"></a>value parts</h3><p>The main characteristic of C types is the memory layouts of their values are transparent</p>
<p>Go can also be viewed as C language framework. This is mainly reflected in the fact that Go supports several kinds of types whose value memory layouts are not totally transparent. Each values of the these kinds of types is often composed of one direct part and one or several underlying indirect parts, and the underlying value part is referenced by the direct value part</p>
<p>Two kinds points</p>
<ul>
<li>If a struct value <code>a</code> has a pointer field <code>b</code> which references a value <code>c</code>, then we can say the struct value <code>a</code> also (indirectly) references value <code>c</code>.</li>
<li>If a value <code>x</code> references (either directly or indirectly) a value <code>y</code>, and the value <code>y</code> references (either directly or indirectly) a value <code>z</code>, then we can also say the value <code>x</code> (indirectly) references value <code>z</code></li>
</ul>
<p>Internal Definitions of the types</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map types</span></span><br><span class="line"><span class="keyword">type</span> _map *hashtableImpl <span class="comment">// currently, for the standard Go compiler,</span></span><br><span class="line">                         <span class="comment">// Go maps are hashtables actually.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// channel types</span></span><br><span class="line"><span class="keyword">type</span> _channel *channelImpl</span><br><span class="line"></span><br><span class="line"><span class="comment">// function types</span></span><br><span class="line"><span class="keyword">type</span> _function *functionImpl</span><br><span class="line"></span><br><span class="line"><span class="comment">// slice types</span></span><br><span class="line"><span class="keyword">type</span> _slice <span class="keyword">struct</span> &#123;</span><br><span class="line">	elements unsafe.Pointer <span class="comment">// underlying elements</span></span><br><span class="line">	<span class="built_in">len</span>      <span class="keyword">int</span>            <span class="comment">// number of elements</span></span><br><span class="line">	<span class="built_in">cap</span>      <span class="keyword">int</span>            <span class="comment">// capacity</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// string types</span></span><br><span class="line"><span class="keyword">type</span> _string <span class="keyword">struct</span> &#123;</span><br><span class="line">	elements *<span class="keyword">byte</span> <span class="comment">// underlying bytes</span></span><br><span class="line">	<span class="built_in">len</span>      <span class="keyword">int</span>   <span class="comment">// number of bytes</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// general interface types</span></span><br><span class="line"><span class="keyword">type</span> _interface <span class="keyword">struct</span> &#123;</span><br><span class="line">	dynamicTypeInfo *<span class="keyword">struct</span> &#123;</span><br><span class="line">		dynamicType *_type       <span class="comment">// the dynamic type</span></span><br><span class="line">		methods     []*_function <span class="comment">// implemented methods</span></span><br><span class="line">	&#125;</span><br><span class="line">	dynamicValue unsafe.Pointer <span class="comment">// the dynamic value</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>underlying value parts are not copied in value assignments</strong></p>
<p>In Go, each value assignment (including parameter passing, etc) is a shallow value copy if the involved destination and source values have the same type (if their types are different, we can think that the source value will be implicitly converted to the destination type before doing that assignment). In other words, only the direct part of the soruce value is copied to the destination value in an value assignment. If the source value has underlying value part(s), then the direct parts of the destination and source values will reference the same underlying value part(s), in other words, <strong>the destination and source values will share the same underlying value part(s)</strong>. </p>
<p>Here I just list some absolutely <strong>misuses of <em>reference</em></strong></p>
<ul>
<li>only slice, map, channel and function types are reference types in Go. (If we do need the <strong>reference type</strong> terminology in Go, then we shouldn’t exclude any custom pointer and pointer wrapper types from reference types).</li>
<li>references are opposites of values. (If we do need the <strong>reference value</strong> terminology in Go, then please view reference values as special values, instead of opposites of values.)</li>
<li>some parameters are passed by reference. (Sorry, all parameters are passed by copy in Go.)</li>
</ul>
<h3 id="line-break-rules-in-go"><a href="#line-break-rules-in-go" class="headerlink" title="line break rules in go"></a>line break rules in go</h3><p>One rule we often obey in practice is, we should not put the a starting curly brace (<code>&#123;</code>) of the explicit code block of a <a target="_blank" rel="noopener" href="https://go101.org/article/control-flow.html">control flow block</a> on a new line.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i := <span class="number">5</span>; i &gt; <span class="number">0</span>; i-- &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>However, there are some exceptions for the rule mentioned above. For example, the following bare <code>for</code> loop block compiles okay.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// do something ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>活用<code>;</code></p>
<h3 id="Some-Panic-Recover-Use-Cases"><a href="#Some-Panic-Recover-Use-Cases" class="headerlink" title="Some Panic/Recover Use Cases"></a>Some Panic/Recover Use Cases</h3><p>avoid panics crashing programs</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;errors&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;net&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	listener, err := net.Listen(<span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;:12345&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalln(err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		conn, err := listener.Accept()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Println(err)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// Handle each client connection in a new goroutine.</span></span><br><span class="line">		<span class="keyword">go</span> ClientHandler(conn)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ClientHandler</span><span class="params">(c net.Conn)</span></span> &#123;</span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> v := <span class="built_in">recover</span>(); v != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Println(<span class="string">&quot;client handler panic:&quot;</span>, v)</span><br><span class="line">		&#125;</span><br><span class="line">		c.Close()</span><br><span class="line">	&#125;()</span><br><span class="line">	<span class="built_in">panic</span>(errors.New(<span class="string">&quot;just a demo.&quot;</span>)) <span class="comment">// a demo-purpose panic</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>automatically restart a crash goroutine</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">shouldNotExit</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		time.Sleep(time.Second) <span class="comment">// simulate a workload</span></span><br><span class="line">		<span class="comment">// Simultate an unexpected panic.</span></span><br><span class="line">		<span class="keyword">if</span> time.Now().UnixNano() &amp; <span class="number">0x3</span> == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="built_in">panic</span>(<span class="string">&quot;unexpected situation&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NeverExit</span><span class="params">(name <span class="keyword">string</span>, f <span class="keyword">func</span>()</span>)</span> &#123;</span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">if</span> v := <span class="built_in">recover</span>(); v != <span class="literal">nil</span> &#123; <span class="comment">// a panic is detected.</span></span><br><span class="line">			log.Println(name, <span class="string">&quot;is crashed. Restart it now.&quot;</span>)</span><br><span class="line">			<span class="keyword">go</span> NeverExit(name, f) <span class="comment">// restart</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line">	f()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	log.SetFlags(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">go</span> NeverExit(<span class="string">&quot;job#A&quot;</span>, shouldNotExit)</span><br><span class="line">	<span class="keyword">go</span> NeverExit(<span class="string">&quot;job#B&quot;</span>, shouldNotExit)</span><br><span class="line">	<span class="keyword">select</span>&#123;&#125; <span class="comment">// blocks here for ever</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>use panic/recover to reduce error checkings</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">doTask</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> n%<span class="number">2</span> != <span class="number">0</span> &#123;</span><br><span class="line">		<span class="comment">// Create a demo-purpose panic.</span></span><br><span class="line">		<span class="built_in">panic</span>(fmt.Errorf(<span class="string">&quot;bad number: %v&quot;</span>, n))</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">doSomething</span><span class="params">()</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="comment">// The ok return must be present here, otherwise,</span></span><br><span class="line">		<span class="comment">// a panic will be created if no errors occur.</span></span><br><span class="line">		err, _ = <span class="built_in">recover</span>().(error)</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	doTask(<span class="number">22</span>)</span><br><span class="line">	doTask(<span class="number">98</span>)</span><br><span class="line">	doTask(<span class="number">100</span>)</span><br><span class="line">	doTask(<span class="number">53</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(doSomething()) <span class="comment">// bad number: 53</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="close-channel"><a href="#close-channel" class="headerlink" title="close channel"></a>close channel</h3><p>One general principle of using Go channels is <strong>don’t close a channel from the receiver side and don’t close a channel if the channel has multiple concurrent senders</strong>. In other words, you should only close a channel in a sender goroutine if the sender is the only sender of the channel.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://gqlxj1987.github.io/2018/04/02/flipkart-data-platform/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="gqlxj1987">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DevilKing's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/02/flipkart-data-platform/" class="post-title-link" itemprop="url">Flipkart Data Platform</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-02 16:59:43" itemprop="dateCreated datePublished" datetime="2018-04-02T16:59:43+08:00">2018-04-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/data-platform/" itemprop="url" rel="index"><span itemprop="name">data platform</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://tech.flipkart.com/overview-of-flipkart-data-platform-20c6d3e9a196">原文链接</a></p>
<p>To give some perspective on the data scale at Flipkart, FDP currently manages a 800+ nodes Hadoop cluster to store more than 35 PB of data. We also run close to 25,000 compute pipelines on our Yarn cluster. Daily TBs of data is ingested into FDP and it also handles data spikes because of sale events. The tech stack majorly comprises of HDFS, Hive, Yarn, MR, Spark, Storm &amp; other API services supporting the meta layer of the data</p>
<p>Overall FDP can be broken down into following high level components.</p>
<ol>
<li>Ingestion System</li>
<li>Batch Data Processing System</li>
<li>Real time Processing System</li>
<li>Report Visualization</li>
<li>Query Platform</li>
</ol>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*TVaSyKyj2vrk5qvy." alt="data-platform"></p>
<p>The streaming platform allows near real time aggregations to be built on all the ingested data. We also have the ability of generating rolling window aggregations i.e. 5 mins, 1 hour, 1 day, 1 month or Historic for each of the metrics.</p>
<p><a target="_blank" rel="noopener" href="https://lens.apache.org/">Apache Lens</a> 接入hive等</p>
<p><img src="https://lens.apache.org/images/arch.png" alt="apache lens架构"></p>
<hr>
<h2 id="ETL"><a href="#ETL" class="headerlink" title="ETL"></a>ETL</h2><p><a target="_blank" rel="noopener" href="https://tech.flipkart.com/expressing-etl-workflows-via-cascading-192eb5e7d85d">原文链接</a></p>
<p>At the onset of Recommendation platform, we started with raw MapReduce(MR) which gave us granular control over our pipeline but required a lot of boilerplate code for performing joins and aggregations that constituted the building blocks of our ETL flow</p>
<p>mapreduce vs cascading</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*Jl9t0eRZYu69hfcR." alt="map reduce vs cascading"></p>
<hr>
<h2 id="REAL-TIME-SEACH-INDEX"><a href="#REAL-TIME-SEACH-INDEX" class="headerlink" title="REAL TIME SEACH INDEX"></a>REAL TIME SEACH INDEX</h2><p><a target="_blank" rel="noopener" href="https://tech.flipkart.com/sherlock-near-real-time-search-indexing-95519783859d">原文链接</a></p>
<p>The Sherlock team developed an innovative solution (NRT data store) to deliver near real-time search results and presented it at Lucene Revolution <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=05rX0mJ2N4U">video</a></p>
<p>高频繁的更新操作，</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*kq_TCklDIPoe_ro1." alt="Sherlock Ingestion Overview"></p>
<p><a target="_blank" rel="noopener" href="https://www.slideshare.net/lucidworks/near-real-time-indexing-presented-by-umesh-prasad-thejus-v-m-flipkart">sides</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/95/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/95/">95</a><span class="page-number current">96</span><a class="page-number" href="/page/97/">97</a><span class="space">&hellip;</span><a class="page-number" href="/page/132/">132</a><a class="extend next" rel="next" href="/page/97/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="gqlxj1987"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">gqlxj1987</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">656</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">239</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">245</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
<div class="site-state-wrap motion-element subtitle">冷灯看剑，剑上几分功名？炉香无需计苍生，纵一穿烟逝，万丈云埋，孤阳还照古陵</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">gqlxj1987</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
